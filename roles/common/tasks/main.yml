# main.yml - config for all common role servers goes in here..
#
######################################################################
# Some configuration defaults which may overlap the kickstart file   #
# settings but which will help keep specific server settings in sync.#
######################################################################
---

- name: configure /etc/hosts file
  template: src={{ item }} dest=/etc/hosts owner=root group=root mode=644
  with_first_found:
    - files:
       - hosts-{{ env }}.j2
       - hosts.j2
      paths:
       - /etc/ansible/roles/common/templates/
  tags:
    - hostfile


- name: Manage /etc/ssh/ssh_known_hosts 
  template: src=known_hosts.j2 dest=/etc/ssh/ssh_known_hosts
            owner=root group=root mode=0644
  tags:
    - knownhosts

- name: configure message of the day 
  template: src=motd.j2 dest=/etc/motd owner=root group=root mode=644
  tags:
    - motd


- name: copy vmware tools install script to /usr/bin
  copy: src=vmtools.pl dest=/usr/bin/vmtools.pl owner=root group=root mode=755
  tags:
    - vmtools

###########################################################################
# specific include files go here as so to keep this file cleaner/readable #
# #########################################################################

- include: pubkey.yml                   # root ssh pub key
- include: logs.yml                     # configure logs
- include: timelocale.yml               # configure time/locale
- include: iocpre.yml                   # ioc prerequisites
